{"version":3,"sources":["images/signin.svg","images/calendar.svg","images/genericError.svg","translations lazy /^/.//.*//strings/.json$/ groupOptions: {} namespace object","localization/translate.ts","SigninPage.tsx","auth/actions.ts","auth/msalApp.ts","MeetingPage.tsx","meeting-creator/validators.ts","meeting-creator/actions.ts","meeting-creator/models.ts","meeting-creator/reducers.ts","components/header.tsx","CopyMeetingPage.tsx","CreateLandingPage.tsx","ErrorPage.tsx","App.tsx","RootReducer.ts","auth/middleware.ts","meeting-creator/middleware.ts","meeting-creator/service.ts","index.tsx"],"names":["module","exports","map","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","e","Error","code","ids","id","t","keys","Object","supportedLocales","getUserLocale","locale","paramlocale","URL","document","location","href","searchParams","get","_","includes","indexOf","split","push","navigator","languages","toLocaleLowerCase","language","userLocale","loadTranslations","a","translations","translatedStrings","sessionStorage","setItem","JSON","stringify","default","storedTranslations","getItem","messages","parse","cache","createIntlCache","int","createIntl","console","log","error","translate","values","formatMessage","boldStyle","root","fontWeight","FontWeights","semibold","connect","state","dispatch","onSignIn","type","props","className","xmlns","width","height","d","fill","Stack","horizontalAlign","verticalAlign","verticalFill","tokens","childrenGap","src","signInImage","alt","Text","variant","styles","PrimaryButton","onClick","ariaLabel","msalApp","UserAgentApplication","auth","clientId","authority","validateAuthority","postLogoutRedirectUri","navigateToLoginRequestUrl","cacheLocation","storeAuthStateInCookie","ua","window","userAgent","msie","msie11","isIE","system","navigateFrameWait","formatDuration","duration","str","Math","floor","asDays","hours","minutes","meetingIconClass","mergeStyles","fontSize","margin","position","top","backgroundColor","padding","color","borderRadius","inputIconClass","DateTimePicker","timeSuggestions","range","projectedEndTime","moment","dateTime","startOf","add","isDisabled","minDate","isAfter","timeTag","format","projectedDuration","diff","projectedDurationString","trim","key","text","includeDuration","length","disabled","horizontal","DatePicker","borderless","firstDayOfWeek","localeData","strings","months","shortMonths","monthsShort","days","weekdays","shortDays","weekdaysMin","goToToday","prevMonthAriaLabel","nextMonthAriaLabel","prevYearAriaLabel","nextYearAriaLabel","closeButtonAriaLabel","getDatePickerStrings","value","toDate","formatDate","dateToFormat","parseDateFromString","onSelectDate","date","currentDateTime","offsetFromStartOfDay","newDateTime","onTimeUpdated","ComboBox","maxHeight","useComboBoxAsMenuWidth","scrollSelectedToTop","allowFreeform","autoComplete","options","onChange","event","option","index","currentDateTimeStartOfDay","enteredTime","isValid","iconName","FontIcon","meeting","inputMeeting","creationInProgress","validationFailures","invalidTitle","subject","undefined","setMeeting","createMeeting","cancel","goBack","useState","validationEnabled","setValidationEnabled","onCreate","Spinner","size","SpinnerSize","large","StackItem","grow","align","DefaultButton","TextField","placeholder","underlined","evt","newValue","nextMeeting","cloneDeep","errorMessage","startDateTime","isSameOrAfter","endDateTime","existingDelta","newEndDateTime","createDefaultMeetingInput","meetingReducer","action","createdMeeting","LOCATION_CHANGE","payload","pathname","bold","Header","onSignOut","viewBox","cx","cy","r","opacity","gradientUnits","x1","y1","x2","y2","gradientTransform","offset","style","stopColor","IconButton","iconProps","title","onCopyToClipboard","getElementById","innerHTML","listener","clipboardData","setData","joinWebUrl","preventDefault","addEventListener","execCommand","removeEventListener","Item","block","dangerouslySetInnerHTML","__html","preview","checkForSignedInUser","onNewMeeting","React","useEffect","calendar","retryCreateMeeting","replace","errorImage","initializeIcons","history","hist","createHashHistory","store","createStore","combineReducers","router","connectRouter","compose","applyMiddleware","routerMiddleware","next","getAccount","loginPopup","scopes","response","idToken","catch","logout","service","acquireTokenSilent","token","acquireTokenPopup","requestBody","toISOString","axios","post","headers","Authorization","accessToken","decodeURIComponent","data","joinInformation","content","creationDateTime","joinUrl","conferenceId","audioConferencing","tollNumber","tollFreeNumber","dialinUrl","videoTeleconferenceId","url","clientDomain","returnUrl","returnUrlSearchParams","set","msession","search","toString","createMeetingMiddleware","App","exact","path","component","SigninPage","MeetingPage","CopyMeetingPage","ErrorPage","CreateLandingPage","hash","some","param","isMsalRedirect","getMessages","ReactDOM","render"],"mappings":"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","file":"static/js/main.e738a99b.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/signin.17dc7748.svg\";","module.exports = __webpack_public_path__ + \"static/media/calendar.e1f946d5.svg\";","module.exports = __webpack_public_path__ + \"static/media/genericError.b4d08b25.svg\";","var map = {\n\t\"./ar/strings.json\": [\n\t\t162,\n\t\t4\n\t],\n\t\"./bg/strings.json\": [\n\t\t163,\n\t\t5\n\t],\n\t\"./cs/strings.json\": [\n\t\t164,\n\t\t6\n\t],\n\t\"./cy/strings.json\": [\n\t\t165,\n\t\t7\n\t],\n\t\"./da/strings.json\": [\n\t\t166,\n\t\t8\n\t],\n\t\"./de/strings.json\": [\n\t\t167,\n\t\t9\n\t],\n\t\"./en-gb/strings.json\": [\n\t\t168,\n\t\t10\n\t],\n\t\"./en-us/strings.json\": [\n\t\t161,\n\t\t0\n\t],\n\t\"./es-mx/strings.json\": [\n\t\t170,\n\t\t11\n\t],\n\t\"./es/strings.json\": [\n\t\t169,\n\t\t12\n\t],\n\t\"./fi/strings.json\": [\n\t\t171,\n\t\t13\n\t],\n\t\"./fr-ca/strings.json\": [\n\t\t173,\n\t\t14\n\t],\n\t\"./fr/strings.json\": [\n\t\t172,\n\t\t15\n\t],\n\t\"./he/strings.json\": [\n\t\t174,\n\t\t16\n\t],\n\t\"./is/strings.json\": [\n\t\t175,\n\t\t17\n\t],\n\t\"./it/strings.json\": [\n\t\t176,\n\t\t18\n\t],\n\t\"./ja/strings.json\": [\n\t\t177,\n\t\t19\n\t],\n\t\"./ko/strings.json\": [\n\t\t178,\n\t\t20\n\t],\n\t\"./nb/strings.json\": [\n\t\t179,\n\t\t21\n\t],\n\t\"./nl/strings.json\": [\n\t\t180,\n\t\t22\n\t],\n\t\"./nn-no/strings.json\": [\n\t\t181,\n\t\t23\n\t],\n\t\"./no/strings.json\": [\n\t\t182,\n\t\t24\n\t],\n\t\"./pl/strings.json\": [\n\t\t183,\n\t\t25\n\t],\n\t\"./pt-br/strings.json\": [\n\t\t184,\n\t\t26\n\t],\n\t\"./pt-pt/strings.json\": [\n\t\t185,\n\t\t27\n\t],\n\t\"./ru/strings.json\": [\n\t\t186,\n\t\t28\n\t],\n\t\"./sv/strings.json\": [\n\t\t187,\n\t\t29\n\t],\n\t\"./th/strings.json\": [\n\t\t188,\n\t\t30\n\t],\n\t\"./tr/strings.json\": [\n\t\t189,\n\t\t31\n\t],\n\t\"./zh-cn/strings.json\": [\n\t\t190,\n\t\t32\n\t],\n\t\"./zh-tw/strings.json\": [\n\t\t191,\n\t\t33\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 3);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 134;\nmodule.exports = webpackAsyncContext;","import { createIntl, createIntlCache } from 'react-intl';\nimport _ from 'lodash';\n\nconst supportedLocales = [\n  'ar',\n  'bg',\n  'cs',\n  'cy',\n  'da',\n  'de',\n  'en-us',\n  'en-gb',\n  'es',\n  'es-mx',\n  'fi',\n  'fr',\n  'fr-ca',\n  'he',\n  'is',\n  'it',\n  'ja',\n  'ko',\n  'nb',\n  'nl',\n  'no',\n  'nn-no',\n  'pl',\n  'pt-br',\n  'pt-pt',\n  'ru',\n  'sv',\n  'th',\n  'tr',\n  'zh-cn',\n  'zh-tw'\n];\n\nexport function getUserLocale() {\n  let locale = [];\n  const url = new URL(document.location.href);\n  let paramlocale = url.searchParams.get('locale');\n\n  if (paramlocale && !_.includes(supportedLocales, paramlocale)) {\n    if (paramlocale.indexOf(\"_\") > -1) {\n      paramlocale = paramlocale.split('_')[0];\n    } else if (paramlocale.indexOf(\"-\") > -1) {\n      paramlocale = paramlocale.split('-')[0];\n    }\n\n  }\n\n  if (paramlocale && _.includes(supportedLocales, paramlocale)) {\n    locale.push(paramlocale);\n  } else if (navigator.languages) {\n    locale.push(navigator.languages[0].toLocaleLowerCase());\n  } else if (navigator.language) {\n    locale.push(navigator.language.toLocaleLowerCase());\n  } else {\n    locale.push('en-us');\n  }\n\n  return locale[0];\n}\n\nconst userLocale = getUserLocale();\n\nasync function loadTranslations() {\n  let translations;\n\n  if (_.includes(supportedLocales, userLocale)) {\n    translations = await import(`../translations/${userLocale}/strings.json`);\n  } else {\n    translations = await import(`../translations/en-us/strings.json`);\n  }\n\n  return translations;\n}\n\nloadTranslations().then((translatedStrings: any) => {\n  sessionStorage.setItem(\n    'translatedStrings',\n    JSON.stringify(translatedStrings.default)\n  );\n});\n\nlet storedTranslations = sessionStorage.getItem('translatedStrings');\n\nexport let messages: any = storedTranslations\n  ? JSON.parse(storedTranslations)\n  : {};\n\nconst cache = createIntlCache();\nlet int = createIntl(\n  {\n    locale: userLocale,\n    messages: messages\n  },\n  cache\n);\n\nexport async function getMessages(): Promise<any>\n{\n  if (!!storedTranslations)\n  {\n    return JSON.parse(storedTranslations);\n  }\n  console.log(\"Translation not cached, loading...\");\n  await loadTranslations();\n\n  // Load the translations into the storedTranslations variable again.\n  storedTranslations = sessionStorage.getItem('translatedStrings');\n\n  if (!storedTranslations)\n  {\n    console.error(\"Unable to load translations\");\n    return {};\n  }\n\n  messages = JSON.parse(storedTranslations);\n  int = createIntl(\n    {\n      locale: userLocale,\n      messages: messages\n    },\n    cache\n  );\n  \n  return messages;\n}\n\nexport const translate = (id: string, values?: {}) => {\n  return int.formatMessage({ id }, values);\n};","import React from 'react';\nimport {\n  Stack,\n  Text,\n  FontWeights,\n  PrimaryButton\n} from 'office-ui-fabric-react';\nimport { AppState } from './RootReducer';\nimport { Dispatch } from 'redux';\nimport { OPEN_SIGNIN_DIALOG_COMMAND } from './auth/actions';\nimport { connect } from 'react-redux';\nimport signInImage from './images/signin.svg';\nimport { FormattedMessage } from 'react-intl';\nimport { translate } from './localization/translate';\n\nimport './index.css';\n\nconst boldStyle = { root: { fontWeight: FontWeights.semibold } };\n\ninterface SigninPageProps {\n  onSignIn: () => void;\n}\n\nconst mapStateToProps = (state: AppState) => ({} as Partial<SigninPageProps>);\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  ({\n    onSignIn: () =>\n      dispatch({\n        type: OPEN_SIGNIN_DIALOG_COMMAND\n      })\n  } as Partial<SigninPageProps>);\n\nfunction SigninPageComponent(props: Partial<SigninPageProps>) {\n  const onSignIn = props.onSignIn ?? (() => {});\n\n  return (\n    <>\n      <div className=\"microsoftLogo\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"108\" height=\"24\">\n          <path\n            d=\"M44.836 4.6v13.8h-2.4V7.583H42.4L38.119 18.4h-1.588L32.142 7.583h-.029V18.4H29.9V4.6h3.436L37.3 14.83h.058L41.545 4.6zm2 1.049a1.268 1.268 0 01.419-.967 1.413 1.413 0 011-.39 1.392 1.392 0 011.02.4 1.3 1.3 0 01.4.958 1.248 1.248 0 01-.414.953 1.428 1.428 0 01-1.01.385A1.4 1.4 0 0147.25 6.6a1.261 1.261 0 01-.409-.948M49.41 18.4h-2.329V8.507h2.329zm7.064-1.694a3.213 3.213 0 001.145-.241 4.811 4.811 0 001.155-.635V18a4.665 4.665 0 01-1.266.481 6.886 6.886 0 01-1.554.164 4.707 4.707 0 01-4.918-4.908 5.641 5.641 0 011.4-3.932 5.055 5.055 0 013.955-1.545 5.414 5.414 0 011.324.168 4.431 4.431 0 011.063.39v2.233a4.763 4.763 0 00-1.1-.611 3.184 3.184 0 00-1.15-.217 2.919 2.919 0 00-2.223.9 3.37 3.37 0 00-.847 2.416 3.216 3.216 0 00.813 2.338 2.936 2.936 0 002.209.837m8.92-8.371a2.952 2.952 0 01.5.039 2.1 2.1 0 01.375.1v2.358a2.04 2.04 0 00-.534-.255 2.646 2.646 0 00-.852-.12 1.808 1.808 0 00-1.448.722 3.467 3.467 0 00-.592 2.223v4.99h-2.324V8.507h2.329v1.559h.038a2.729 2.729 0 01.963-1.266 2.611 2.611 0 011.545-.457m1 5.254a5.358 5.358 0 011.392-3.887 5.1 5.1 0 013.85-1.434 4.742 4.742 0 013.623 1.381 5.212 5.212 0 011.3 3.729 5.257 5.257 0 01-1.386 3.83 5.019 5.019 0 01-3.772 1.424 4.935 4.935 0 01-3.652-1.352 4.987 4.987 0 01-1.349-3.688m2.425-.077a3.535 3.535 0 00.7 2.368 2.505 2.505 0 002.011.818 2.345 2.345 0 001.934-.818 3.783 3.783 0 00.664-2.425 3.651 3.651 0 00-.688-2.411 2.389 2.389 0 00-1.929-.813 2.44 2.44 0 00-1.988.852 3.707 3.707 0 00-.707 2.43m11.2-2.416a1 1 0 00.318.785 5.426 5.426 0 001.4.717 4.767 4.767 0 011.959 1.256 2.6 2.6 0 01.563 1.689 2.715 2.715 0 01-1.068 2.239 4.558 4.558 0 01-2.9.847 6.978 6.978 0 01-1.362-.149 6.047 6.047 0 01-1.265-.38v-2.29a5.733 5.733 0 001.367.7 4 4 0 001.328.26 2.365 2.365 0 001.164-.221.79.79 0 00.375-.741 1.029 1.029 0 00-.39-.813 5.768 5.768 0 00-1.477-.765 4.564 4.564 0 01-1.829-1.213 2.655 2.655 0 01-.539-1.713 2.706 2.706 0 011.063-2.2 4.243 4.243 0 012.765-.86 6.663 6.663 0 011.164.115 5.161 5.161 0 011.078.3v2.214a4.974 4.974 0 00-1.078-.529 3.6 3.6 0 00-1.222-.221 1.781 1.781 0 00-1.034.26.824.824 0 00-.371.712m5.241 2.493a5.358 5.358 0 011.386-3.89 5.1 5.1 0 013.849-1.434 4.743 4.743 0 013.624 1.381 5.212 5.212 0 011.3 3.729 5.259 5.259 0 01-1.386 3.83 5.02 5.02 0 01-3.773 1.424 4.934 4.934 0 01-3.652-1.352 4.987 4.987 0 01-1.348-3.688m2.425-.077a3.537 3.537 0 00.7 2.368 2.506 2.506 0 002.011.818 2.345 2.345 0 001.934-.818 3.783 3.783 0 00.664-2.425 3.651 3.651 0 00-.688-2.411 2.39 2.39 0 00-1.93-.813 2.439 2.439 0 00-1.987.852 3.707 3.707 0 00-.707 2.43m15.464-3.109H99.7V18.4h-2.359v-7.988h-1.655V8.507h1.655V7.13a3.423 3.423 0 011.015-2.555 3.561 3.561 0 012.6-1 5.807 5.807 0 01.751.043 2.993 2.993 0 01.577.13v2.016a2.422 2.422 0 00-.4-.164 2.107 2.107 0 00-.664-.1 1.407 1.407 0 00-1.126.457 2.017 2.017 0 00-.394 1.356v1.194h3.469V6.283l2.339-.712v2.936h2.358v1.906h-2.358v4.629a1.951 1.951 0 00.332 1.29 1.326 1.326 0 001.044.375 1.557 1.557 0 00.486-.1 2.294 2.294 0 00.5-.231V18.3a2.737 2.737 0 01-.736.231 5.029 5.029 0 01-1.015.106 2.887 2.887 0 01-2.209-.784 3.341 3.341 0 01-.736-2.363z\"\n            fill=\"#737373\"\n          />\n          <path fill=\"#f25022\" d=\"M0 0h10.931v10.931H0z\" />\n          <path fill=\"#7fba00\" d=\"M12.069 0H23v10.931H12.069z\" />\n          <path fill=\"#00a4ef\" d=\"M0 12.069h10.931V23H0z\" />\n          <path fill=\"#ffb900\" d=\"M12.069 12.069H23V23H12.069z\" />\n        </svg>\n      </div>\n\n      <Stack\n        className=\"container\"\n        horizontalAlign=\"center\"\n        verticalAlign=\"center\"\n        verticalFill\n        tokens={{\n          childrenGap: 35\n        }}\n      >\n        <img\n          className=\"splashImage\"\n          src={signInImage}\n          alt={translate('signin.logo')}\n        />\n        <Text variant=\"xLargePlus\" styles={boldStyle} className=\"signinHeader\">\n          <FormattedMessage id=\"signin.header\" />\n        </Text>\n\n        <Text variant=\"medium\" className=\"uTextCenter signinSubHeader\">\n          <FormattedMessage id=\"signin.subheader.lead\" />\n        </Text>\n        <Text variant=\"medium\" className=\"uTextCenter signinSubHeader\">\n          <FormattedMessage id=\"signin.subheader.signin\" />\n        </Text>\n\n        <PrimaryButton\n          className=\"teamsButton\"\n          onClick={() => onSignIn()}\n          ariaLabel={translate('signin.button.ariaLabel')}\n        >\n          <FormattedMessage id=\"signin.button\" />\n        </PrimaryButton>\n      </Stack>\n    </>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SigninPageComponent);\n","import { IdToken } from 'msal/lib-commonjs/IdToken';\n\nexport const CHECK_FOR_SIGNEDIN_USER_COMMAND = 'CheckForSignedInUserCommand';\nexport interface CheckForSignedInUserCommand {\n  type: typeof CHECK_FOR_SIGNEDIN_USER_COMMAND;\n}\n\nexport const OPEN_SIGNIN_DIALOG_COMMAND = 'OpenSigninDialogCommand';\nexport interface OpenSigninDialogCommand {\n  type: typeof OPEN_SIGNIN_DIALOG_COMMAND;\n}\n\nexport const SIGNIN_COMPLETE_EVENT = 'SigninCompleteEvent';\nexport interface SigninCompleteEvent {\n  type: typeof SIGNIN_COMPLETE_EVENT;\n  idToken: IdToken;\n}\n\nexport const SIGNOUT_COMMAND = 'SignoutCommand';\nexport interface SignoutCommand {\n  type: typeof SIGNOUT_COMMAND;\n}\n\nexport const SIGNOUT_COMPLETE_EVENT = 'SignoutCompleteEvent';\nexport interface SignoutCompleteEvent {\n  type: typeof SIGNOUT_COMPLETE_EVENT;\n}\n\nexport type AuthAction =\n  | CheckForSignedInUserCommand\n  | OpenSigninDialogCommand\n  | SigninCompleteEvent\n  | SignoutCommand\n  | SignoutCompleteEvent;\n","//shamelessly stolen from: https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/samples/react-sample-app/src/auth-utils.js\nimport { UserAgentApplication } from 'msal';\n\nfunction isIE() {\n  const ua = window.navigator.userAgent;\n  const msie = ua.indexOf('MSIE ') > -1;\n  const msie11 = ua.indexOf('Trident/') > -1;\n\n  // If you as a developer are testing using Edge InPrivate mode, please add \"isEdge\" to the if check\n  // const isEdge = ua.indexOf(\"Edge/\") > -1;\n  return msie || msie11;\n}\n\nexport const msalApp = new UserAgentApplication({\n  auth: {\n        clientId: 'e43b2148-e339-46e5-858a-64d00f9747f1',\n    authority: 'https://login.microsoftonline.com/common',\n    validateAuthority: true,\n    postLogoutRedirectUri: 'https://nice-sky-0980a0100.azurestaticapps.net',\n    navigateToLoginRequestUrl: false\n  },\n  cache: {\n    cacheLocation: 'sessionStorage',\n    storeAuthStateInCookie: isIE()\n  },\n  system: {\n    navigateFrameWait: 0\n  }\n});","import React, { useState } from 'react';\nimport {\n  Stack,\n  Text,\n  FontWeights,\n  PrimaryButton,\n  DefaultButton,\n  StackItem,\n  TextField,\n  DatePicker,\n  IDatePickerStrings,\n  DayOfWeek,\n  ComboBox,\n  IComboBoxOption,\n  IComboBox,\n  Spinner,\n  SpinnerSize\n} from 'office-ui-fabric-react';\nimport { FontIcon } from 'office-ui-fabric-react/lib/Icon';\nimport { AppState } from './RootReducer';\nimport { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { mergeStyles } from 'office-ui-fabric-react/lib/Styling';\nimport _ from 'lodash';\nimport moment, { Moment, Duration } from 'moment';\nimport { OnlineMeetingInput } from './meeting-creator/models';\nimport {\n  SET_MEETING_COMMAND,\n  CREATE_MEETING_COMMAND,\n  CreateMeetingCommand\n} from './meeting-creator/actions';\nimport { goBack } from 'connected-react-router';\nimport { hasValidSubject } from './meeting-creator/validators';\nimport { FormattedMessage } from 'react-intl';\nimport { translate } from './localization/translate';\n\nconst boldStyle = { root: { fontWeight: FontWeights.semibold } };\n\nfunction formatDuration(duration: Duration) {\n  let str = '';\n  if (Math.floor(duration.asDays()) > 0) {\n    str += `${Math.floor(duration.asDays())}d `;\n  }\n  if (duration.hours() > 0) {\n    str += `${duration.hours()}h `;\n  }\n  if (duration.minutes() > 0) {\n    str += `${duration.minutes()}m `;\n  }\n  return str;\n}\n\nconst datePickerFormat = 'll';\nconst timePickerFormat = 'LT';\n\nconst meetingIconClass = mergeStyles({\n  fontSize: 16,\n  height: 16,\n  width: 16,\n  margin: '0 7px',\n  position: 'relative',\n  top: 1,\n  backgroundColor: '#6264a7',\n  padding: '10px',\n  color: '#fff',\n  borderRadius: '3px'\n});\n\nconst inputIconClass = mergeStyles({\n  position: 'relative',\n  top: 7\n});\n\n//\n// Date and time picker component\n//\n\ninterface DateTimePickerProps {\n  dateTime?: Moment;\n  minDate?: Moment;\n  iconName?: string;\n  onTimeUpdated: (date?: Moment) => void;\n  includeDuration: boolean;\n}\n\nfunction DateTimePicker(props: DateTimePickerProps) {\n  function getDatePickerStrings(): IDatePickerStrings {\n    const localeData = moment.localeData();\n    return {\n      months: localeData.months(),\n      shortMonths: localeData.monthsShort(),\n      days: localeData.weekdays(),\n      shortDays: localeData.weekdaysMin(),\n      goToToday: 'Go to today',\n      prevMonthAriaLabel: 'Go to previous month',\n      nextMonthAriaLabel: 'Go to next month',\n      prevYearAriaLabel: 'Go to previous year',\n      nextYearAriaLabel: 'Go to next year',\n      closeButtonAriaLabel: 'Close date picker'\n    };\n  }\n\n  function onDayPicked(date: Date | null | undefined) {\n    const currentDateTime = moment(props.dateTime);\n\n    const offsetFromStartOfDay = currentDateTime.diff(\n      moment(currentDateTime).startOf('day')\n    );\n    const newDateTime = moment(date ?? currentDateTime)\n      .startOf('day')\n      .add(offsetFromStartOfDay);\n\n    props.onTimeUpdated(newDateTime);\n  }\n\n  function onTimePicked(\n    event: React.FormEvent<IComboBox>,\n    option?: IComboBoxOption,\n    index?: number,\n    value?: string\n  ) {\n    const currentDateTimeStartOfDay = moment(props.dateTime).startOf('day');\n\n    let newDateTime: moment.Moment;\n    if (option) {\n      const offsetFromStartOfDay = moment.duration(option.key, 'minutes');\n      newDateTime = currentDateTimeStartOfDay.add(offsetFromStartOfDay);\n    } else {\n      // User entered a free-form string, try to parse it as a time\n      const enteredTime = moment(value, timePickerFormat);\n      if (enteredTime.isValid()) {\n        const offsetFromStartOfDay = enteredTime.diff(\n          moment(enteredTime).startOf('day')\n        );\n        newDateTime = currentDateTimeStartOfDay.add(offsetFromStartOfDay);\n      } else {\n        newDateTime = moment(props.dateTime);\n      }\n    }\n\n    props.onTimeUpdated(newDateTime);\n  }\n\n  function onFormatDate(dateToFormat?: Date): string {\n    return moment(dateToFormat).format(datePickerFormat);\n  }\n\n  function onParseDateFromString(value: string): Date {\n    return moment(value, datePickerFormat).toDate();\n  }\n\n  const timeSuggestions = _.range(0, 1440, 30).map(minutes => {\n    // if the selection is before the min value\n    const projectedEndTime = moment(props.dateTime)\n      .startOf('day')\n      .add(moment.duration(minutes, 'minutes'));\n    const isDisabled = moment(props.minDate).isAfter(projectedEndTime);\n    const timeTag = moment()\n      .startOf('day')\n      .minutes(minutes)\n      .format(timePickerFormat);\n    const projectedDuration = moment.duration(\n      moment(projectedEndTime).diff(props.minDate)\n    );\n    const projectedDurationString = _.trim(formatDuration(projectedDuration));\n\n    return {\n      key: minutes,\n      text:\n        props.includeDuration &&\n        !isDisabled &&\n        projectedDurationString.length > 0\n          ? `${timeTag} (${projectedDurationString})`\n          : timeTag,\n      disabled: isDisabled\n    };\n  });\n\n  return (\n    <Stack horizontal>\n      <DatePicker\n        className=\"newMeetingDatePicker\"\n        borderless\n        firstDayOfWeek={moment.localeData().firstDayOfWeek() as DayOfWeek}\n        strings={getDatePickerStrings()}\n        value={props.dateTime?.toDate()}\n        formatDate={onFormatDate}\n        parseDateFromString={onParseDateFromString}\n        onSelectDate={onDayPicked}\n        minDate={props.minDate?.toDate()}\n      />\n      <ComboBox\n        className=\"newMeetingComboBox\"\n        styles={{ root: { maxHeight: '500px' } }}\n        useComboBoxAsMenuWidth={!props.includeDuration}\n        scrollSelectedToTop={true}\n        allowFreeform={true}\n        autoComplete=\"on\"\n        options={timeSuggestions}\n        onChange={onTimePicked}\n        text={props.dateTime?.format(timePickerFormat)}\n      />\n      {props.iconName === 'ReplyAlt' ? (\n        <FontIcon className=\"newMeetingPickerIcon\" iconName={props.iconName} />\n      ) : (\n        <Text className=\"newMeetingPickerIncrement\" variant=\"smallPlus\">\n          {formatDuration(\n            moment.duration(moment(props.dateTime).diff(moment(props.minDate)))\n          )}\n        </Text>\n      )}\n    </Stack>\n  );\n}\n\n//\n// Meeting page component\n//\n\ninterface MeetingValidationFailures {\n  invalidTitle?: string;\n}\n\ninterface MeetingPageProps {\n  meeting: OnlineMeetingInput;\n  validationFailures: MeetingValidationFailures;\n  creationInProgress: boolean;\n  setMeeting: (meeting: OnlineMeetingInput) => void;\n  createMeeting: (meeting: OnlineMeetingInput) => void;\n  cancel: () => void;\n}\n\nconst mapStateToProps = (state: AppState) => ({\n  meeting: state.meeting.inputMeeting,\n  creationInProgress: state.meeting.creationInProgress,\n  validationFailures: {\n    invalidTitle: hasValidSubject(state.meeting.inputMeeting)\n      ? undefined\n      : 'Invalid subject'\n  }\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  setMeeting: (meeting: OnlineMeetingInput) => {\n    dispatch({\n      type: SET_MEETING_COMMAND,\n      meeting\n    });\n  },\n  createMeeting: (meeting: OnlineMeetingInput) => {\n    dispatch({\n      type: CREATE_MEETING_COMMAND,\n      meeting\n    } as CreateMeetingCommand);\n  },\n  cancel: () => dispatch(goBack())\n});\n\nfunction MeetingPageComponent(props: MeetingPageProps) {\n  const [validationEnabled, setValidationEnabled] = useState(false);\n\n  function onSubjectChanged(\n    evt: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>,\n    newValue: string | undefined\n  ) {\n    // The meeting objects are small, cloning is cheap enough\n    // Normally would use immutable records or similar to avoid overhead.\n    const nextMeeting = _.cloneDeep(props.meeting);\n    nextMeeting.subject = newValue ?? '';\n    props.setMeeting(nextMeeting);\n  }\n\n  function onStartDateSelected(date?: Moment) {\n    const nextMeeting = _.cloneDeep(props.meeting);\n    nextMeeting.startDateTime = date ?? nextMeeting.startDateTime;\n\n    // If start >= end, adjust to be the same delta as before from the start time\n    if (nextMeeting.startDateTime.isSameOrAfter(nextMeeting.endDateTime)) {\n      const existingDelta = moment(props.meeting.endDateTime).diff(\n        moment(props.meeting.startDateTime)\n      );\n      const newEndDateTime = moment(nextMeeting.startDateTime).add(\n        existingDelta\n      );\n      if (nextMeeting.startDateTime.isSameOrAfter(newEndDateTime)) {\n        newEndDateTime.add(existingDelta);\n      }\n      nextMeeting.endDateTime = newEndDateTime;\n    }\n\n    props.setMeeting(nextMeeting);\n  }\n\n  function onEndDateSelected(date?: Moment) {\n    const nextMeeting = _.cloneDeep(props.meeting);\n    const newEndDateTime = date ?? nextMeeting.endDateTime;\n\n    // Allow the change only if it maintains start < end\n    if (!nextMeeting.startDateTime.isAfter(newEndDateTime)) {\n      nextMeeting.endDateTime = newEndDateTime;\n    }\n\n    props.setMeeting(nextMeeting);\n  }\n\n  function onCreate() {\n    if (!!props.validationFailures.invalidTitle) {\n      setValidationEnabled(true);\n      return;\n    }\n\n    props.createMeeting(props.meeting);\n  }\n\n  if (props.creationInProgress) {\n    return (\n      <div className=\"spinnerContainer\">\n        <Spinner size={SpinnerSize.large} />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"newMeetingContainer\">\n      <Stack\n        className=\"container\"\n        verticalFill\n        tokens={{\n          childrenGap: 35\n        }}\n      >\n        <Stack horizontal tokens={{ childrenGap: 15 }}>\n          <StackItem grow>\n            <FontIcon iconName=\"Calendar\" className={meetingIconClass} />\n            <Text variant=\"xLarge\" styles={boldStyle}>\n              <FormattedMessage id=\"meetingPage.header\" />\n            </Text>\n          </StackItem>\n          <StackItem align=\"end\" className=\"newMeetingButtons\">\n            <Stack horizontal tokens={{ childrenGap: 10 }}>\n              <PrimaryButton\n                className=\"teamsButton\"\n                disabled={props.creationInProgress}\n                onClick={() => onCreate()}\n                ariaLabel={translate('meetingPage.create.ariaLabel')}\n              >\n                <FormattedMessage id=\"meetingPage.create\" />\n              </PrimaryButton>\n              <DefaultButton\n                className=\"teamsButtonInverted\"\n                disabled={props.creationInProgress}\n                onClick={() => props.cancel()}\n                ariaLabel={translate('meetingPage.cancel.ariaLabel')}\n              >\n                <FormattedMessage id=\"meetingPage.cancel\" />\n              </DefaultButton>\n            </Stack>\n          </StackItem>\n        </Stack>\n        <Stack horizontal>\n          <StackItem className=\"newMeetingInputIcon\">\n            <FontIcon iconName=\"Edit\" className={inputIconClass} />\n          </StackItem>\n          <StackItem grow>\n            <TextField\n              className=\"newMeetingInput\"\n              placeholder={translate('meetingPage.title.input')}\n              value={props.meeting?.subject}\n              underlined\n              onChange={onSubjectChanged}\n              errorMessage={\n                validationEnabled\n                  ? props.validationFailures.invalidTitle\n                  : undefined\n              }\n            />\n          </StackItem>\n        </Stack>\n\n        <div className=\"newMeetingDatePickerContainer\">\n          <FontIcon iconName=\"Clock\" className={inputIconClass} />\n          <div className=\"newMeetingPicker\">\n            <DateTimePicker\n              dateTime={props.meeting.startDateTime}\n              minDate={moment()}\n              onTimeUpdated={onStartDateSelected}\n              includeDuration={false}\n              iconName=\"ReplyAlt\"\n            />\n            <DateTimePicker\n              dateTime={props.meeting.endDateTime}\n              minDate={props.meeting.startDateTime}\n              onTimeUpdated={onEndDateSelected}\n              includeDuration={true}\n            />\n          </div>\n        </div>\n\n        {/* MOBILE BUTTON GROUP */}\n      </Stack>\n      <StackItem className=\"newMeetingButtonsMobile\">\n        <Stack horizontal tokens={{ childrenGap: 10 }}>\n          <PrimaryButton\n            className=\"teamsButton teamsButtonFullWidth\"\n            disabled={props.creationInProgress}\n            onClick={() => onCreate()}\n            ariaLabel={translate('meetingPage.create.ariaLabel')}\n          >\n            <FormattedMessage id=\"meetingPage.create\" />\n          </PrimaryButton>\n          <DefaultButton\n            className=\"teamsButtonInverted teamsButtonFullWidth\"\n            disabled={props.creationInProgress}\n            onClick={() => props.cancel()}\n            ariaLabel={translate('meetingPage.cancel.ariaLabel')}\n          >\n            <FormattedMessage id=\"meetingPage.cancel\" />\n          </DefaultButton>\n        </Stack>\n      </StackItem>\n    </div>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(MeetingPageComponent);\n","import { OnlineMeetingInput } from './models';\n\nexport function hasValidSubject(meeting: OnlineMeetingInput) {\n  return !!meeting.subject && meeting.subject.length >= 0;\n}\n","import { OnlineMeetingInput, OnlineMeeting } from './models';\n\nexport const SET_MEETING_COMMAND = 'SetMeetingCommand';\nexport interface SetMeetingCommand {\n  type: typeof SET_MEETING_COMMAND;\n  meeting: OnlineMeetingInput;\n}\n\nexport const CREATE_MEETING_COMMAND = 'CreateMeetingCommand';\nexport interface CreateMeetingCommand {\n  type: typeof CREATE_MEETING_COMMAND;\n  meeting: OnlineMeetingInput;\n}\n\nexport const MEETING_CREATED_EVENT = 'MeetingCreatedEvent';\nexport interface MeetingCreatedEvent {\n  type: typeof MEETING_CREATED_EVENT;\n  meeting: OnlineMeeting;\n}\n\nexport type MeetingAction =\n  | SetMeetingCommand\n  | CreateMeetingCommand\n  | MeetingCreatedEvent;\n","import moment from 'moment';\r\nimport { Moment } from 'moment';\r\n\r\nexport interface OnlineMeetingInput {\r\n  subject?: string;\r\n  startDateTime: Moment;\r\n  endDateTime: Moment;\r\n}\r\n\r\nexport interface OnlineMeeting {\r\n  id: string;\r\n  joinWebUrl: string;\r\n  subject: string;\r\n  videoTeleconferenceId: string;\r\n  creationDateTime: Moment;\r\n  startDateTime: Moment;\r\n  endDateTime: Moment;\r\n  dialinUrl: string;\r\n  conferenceId: string;\r\n  tollNumber: string;\r\n  tollFreeNumber: string;\r\n  preview: string;\r\n}\r\n\r\nexport function createDefaultMeetingInput(): OnlineMeetingInput {\r\n  return {\r\n    subject: '',\r\n    startDateTime: moment()\r\n      .startOf('hour')\r\n      .add(1, 'hour'),\r\n    endDateTime: moment()\r\n      .startOf('hour')\r\n      .add(2, 'hour')\r\n  };\r\n}\r\n","import { MeetingState } from './state';\r\nimport {\r\n  SET_MEETING_COMMAND,\r\n  MeetingAction,\r\n  MEETING_CREATED_EVENT,\r\n  CREATE_MEETING_COMMAND\r\n} from './actions';\r\nimport _ from 'lodash';\r\nimport { createDefaultMeetingInput } from './models';\r\nimport {\r\n  LOCATION_CHANGE,\r\n  LocationChangeAction,\r\n  LocationChangePayload\r\n} from 'connected-react-router';\r\n\r\nconst loadInitialState = () => {\r\n  return {\r\n    inputMeeting: createDefaultMeetingInput(),\r\n    creationInProgress: false\r\n  } as MeetingState;\r\n};\r\n\r\nexport const meetingReducer = (\r\n  state: MeetingState,\r\n  action: MeetingAction | LocationChangeAction<LocationChangePayload>\r\n) => {\r\n  if (!state) return loadInitialState();\r\n  switch (action.type) {\r\n    case SET_MEETING_COMMAND:\r\n      return {\r\n        ...state,\r\n        inputMeeting: _.cloneDeep(action.meeting)\r\n      };\r\n    case CREATE_MEETING_COMMAND:\r\n      return {\r\n        ...state,\r\n        creationInProgress: true\r\n      };\r\n    case MEETING_CREATED_EVENT:\r\n      return {\r\n        ...state,\r\n        createdMeeting: action.meeting\r\n      };\r\n    case LOCATION_CHANGE:\r\n      if (action.payload.location.pathname === '/createMeeting') {\r\n        return {\r\n          ...state,\r\n          creationInProgress: false\r\n        };\r\n      }\r\n    // falls through\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Text, FontWeights, IconButton } from 'office-ui-fabric-react';\nimport { AppState } from '../RootReducer';\nimport { Dispatch } from 'redux';\nimport { SIGNOUT_COMMAND } from '../auth/actions';\nimport { translate } from '../localization/translate';\n\ninterface HeaderProps {\n  onSignOut: () => void;\n}\n\nconst mapStateToProps = (state: AppState) => ({} as Partial<HeaderProps>);\n\nconst mapDispatchToProps = (dispatch: Dispatch) =>\n  ({\n    onSignOut: () => {\n      dispatch({\n        type: SIGNOUT_COMMAND\n      });\n    }\n  } as Partial<HeaderProps>);\n\nconst boldStyle = { root: { fontWeight: FontWeights.bold } };\n\nfunction HeaderComponent(props: Partial<HeaderProps>) {\n  const onSignOut = props.onSignOut ?? (() => {});\n\n  return (\n    <div className=\"header\">\n      <div className=\"headerLogo\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 2228.833 2073.333\">\n          <path\n            fill=\"#5059C9\"\n            d=\"M1554.637 777.5h575.713c54.391 0 98.483 44.092 98.483 98.483v524.398c0 199.901-162.051 361.952-361.952 361.952h-1.711c-199.901.028-361.975-162-362.004-361.901V828.971c.001-28.427 23.045-51.471 51.471-51.471z\"\n          />\n          <circle fill=\"#5059C9\" cx=\"1943.75\" cy=\"440.583\" r=\"233.25\" />\n          <circle fill=\"#7B83EB\" cx=\"1218.083\" cy=\"336.917\" r=\"336.917\" />\n          <path\n            fill=\"#7B83EB\"\n            d=\"M1667.323 777.5H717.01c-53.743 1.33-96.257 45.931-95.01 99.676v598.105c-7.505 322.519 247.657 590.16 570.167 598.053 322.51-7.893 577.671-275.534 570.167-598.053V877.176c1.245-53.745-41.268-98.346-95.011-99.676z\"\n          />\n          <path\n            opacity=\".1\"\n            d=\"M1244 777.5v838.145c-.258 38.435-23.549 72.964-59.09 87.598a91.856 91.856 0 01-35.765 7.257H667.613c-6.738-17.105-12.958-34.21-18.142-51.833a631.287 631.287 0 01-27.472-183.49V877.02c-1.246-53.659 41.198-98.19 94.855-99.52H1244z\"\n          />\n          <path\n            opacity=\".2\"\n            d=\"M1192.167 777.5v889.978a91.838 91.838 0 01-7.257 35.765c-14.634 35.541-49.163 58.833-87.598 59.09H691.975c-8.812-17.105-17.105-34.21-24.362-51.833-7.257-17.623-12.958-34.21-18.142-51.833a631.282 631.282 0 01-27.472-183.49V877.02c-1.246-53.659 41.198-98.19 94.855-99.52h475.313z\"\n          />\n          <path\n            opacity=\".2\"\n            d=\"M1192.167 777.5v786.312c-.395 52.223-42.632 94.46-94.855 94.855h-447.84A631.282 631.282 0 01622 1475.177V877.02c-1.246-53.659 41.198-98.19 94.855-99.52h475.312z\"\n          />\n          <path\n            opacity=\".2\"\n            d=\"M1140.333 777.5v786.312c-.395 52.223-42.632 94.46-94.855 94.855H649.472A631.282 631.282 0 01622 1475.177V877.02c-1.246-53.659 41.198-98.19 94.855-99.52h423.478z\"\n          />\n          <path\n            opacity=\".1\"\n            d=\"M1244 509.522v163.275c-8.812.518-17.105 1.037-25.917 1.037-8.812 0-17.105-.518-25.917-1.037a284.472 284.472 0 01-51.833-8.293c-104.963-24.857-191.679-98.469-233.25-198.003a288.02 288.02 0 01-16.587-51.833h258.648c52.305.198 94.657 42.549 94.856 94.854z\"\n          />\n          <path\n            opacity=\".2\"\n            d=\"M1192.167 561.355v111.442a284.472 284.472 0 01-51.833-8.293c-104.963-24.857-191.679-98.469-233.25-198.003h190.228c52.304.198 94.656 42.55 94.855 94.854z\"\n          />\n          <path\n            opacity=\".2\"\n            d=\"M1192.167 561.355v111.442a284.472 284.472 0 01-51.833-8.293c-104.963-24.857-191.679-98.469-233.25-198.003h190.228c52.304.198 94.656 42.55 94.855 94.854z\"\n          />\n          <path\n            opacity=\".2\"\n            d=\"M1140.333 561.355v103.148c-104.963-24.857-191.679-98.469-233.25-198.003h138.395c52.305.199 94.656 42.551 94.855 94.855z\"\n          />\n          <linearGradient\n            id=\"a\"\n            gradientUnits=\"userSpaceOnUse\"\n            x1=\"198.099\"\n            y1=\"1683.073\"\n            x2=\"942.234\"\n            y2=\"394.261\"\n            gradientTransform=\"matrix(1 0 0 -1 0 2075.333)\"\n          >\n            <stop offset=\"0\" style={{ stopColor: '#5a62c3' }} />\n            <stop offset=\".5\" style={{ stopColor: '#4d55bd' }} />\n            <stop offset=\"1\" style={{ stopColor: '#3940ab' }} />\n          </linearGradient>\n          <path\n            fill=\"url(#a)\"\n            d=\"M95.01 466.5h950.312c52.473 0 95.01 42.538 95.01 95.01v950.312c0 52.473-42.538 95.01-95.01 95.01H95.01c-52.473 0-95.01-42.538-95.01-95.01V561.51c0-52.472 42.538-95.01 95.01-95.01z\"\n          />\n          <path\n            fill=\"#FFF\"\n            d=\"M820.211 828.193h-189.97v517.297h-121.03V828.193H320.123V727.844h500.088v100.349z\"\n          />\n        </svg>\n      </div>\n\n      <div>\n        <Text variant=\"xLarge\" styles={boldStyle}>\n          Microsoft Teams\n        </Text>\n      </div>\n\n      <div className=\"headerIcon\">\n        <IconButton\n          onClick={() => onSignOut()}\n          iconProps={{ iconName: 'Leave' }}\n          title={translate('header.signout.title')}\n          ariaLabel={translate('header.signout.ariaLabel')}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport const Header = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HeaderComponent);\n","import React from 'react';\nimport { Stack, Text, PrimaryButton } from 'office-ui-fabric-react';\nimport { AppState } from './RootReducer';\nimport { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { OnlineMeeting } from './meeting-creator/models';\nimport { Header } from './components/header';\nimport { FormattedMessage } from 'react-intl';\nimport { translate } from './localization/translate';\n\ninterface CopyMeetingPageProps {\n  meeting?: OnlineMeeting;\n  onCopyToClipboard: (meeting?: OnlineMeeting) => void;\n}\n\nconst mapStateToProps = (state: AppState) => ({\n  meeting: state.meeting.createdMeeting\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  onCopyToClipboard: (meeting?: OnlineMeeting) => {\n    const str =\n      document.getElementById('copy')?.innerHTML ||\n      translate('copyMeetingPage.failed.copy');\n\n    function listener(e: ClipboardEvent) {\n      if (!e || !e.clipboardData) {\n        return;\n      }\n\n      e.clipboardData.setData('text/html', str);\n      e.clipboardData.setData(\n        'text/plain',\n        meeting?.joinWebUrl ?? translate('copyMeetingPage.failed.copy')\n      );\n      e.preventDefault();\n    }\n    document.addEventListener('copy', listener);\n    document.execCommand('copy');\n    document.removeEventListener('copy', listener);\n  }\n});\n\nfunction CopyMeetingPageComponent(props: CopyMeetingPageProps) {\n  return (\n    <>\n      <Header />\n      <Stack\n        className=\"container\"\n        verticalFill\n        tokens={{\n          childrenGap: 35\n        }}\n      >\n        <Stack.Item align=\"center\" className=\"meetingCardContainer\">\n          <svg\n            className=\"meetingSuccess\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 48 48\"\n          >\n            <path\n              d=\"M24 0c2.2 0 4.3.3 6.4.9 2 .6 3.9 1.4 5.7 2.4 1.8 1 3.4 2.3 4.9 3.8 1.5 1.5 2.7 3.1 3.8 4.9 1 1.8 1.8 3.7 2.4 5.7.6 2 .9 4.2.9 6.4s-.3 4.3-.9 6.3c-.6 2-1.4 3.9-2.4 5.7-1 1.8-2.3 3.4-3.8 4.9-1.5 1.5-3.1 2.7-4.9 3.8-1.8 1-3.7 1.9-5.7 2.4-2 .6-4.1.9-6.4.9-2.2 0-4.3-.3-6.3-.9-2-.6-3.9-1.4-5.7-2.4-1.8-1-3.4-2.3-4.9-3.8-1.5-1.5-2.7-3.1-3.8-4.9-1-1.8-1.9-3.7-2.4-5.7C.3 28.3 0 26.2 0 24s.3-4.3.9-6.4c.6-2 1.4-3.9 2.4-5.7 1-1.8 2.3-3.4 3.8-4.9 1.5-1.5 3.1-2.7 4.9-3.8 1.8-1 3.7-1.9 5.7-2.4S21.8 0 24 0zm7.9 17.1c-.6 0-1.2.2-1.6.7l-8.5 8.5-3-3c-.4-.4-1-.7-1.6-.7-.3 0-.6.1-.8.2-.3.1-.5.3-.7.5s-.4.4-.5.7c-.2.3-.2.5-.2.8 0 .6.2 1.2.7 1.6l4.6 4.6c.4.4 1 .7 1.6.7.6 0 1.2-.2 1.6-.7l10.1-10.1c.4-.5.7-1 .7-1.6 0-.3-.1-.6-.2-.8-.1-.3-.3-.5-.5-.7s-.4-.4-.7-.5c-.4-.2-.7-.2-1-.2z\"\n              fill=\"#599c00\"\n            />\n          </svg>\n\n          <Text block variant=\"xLarge\" className=\"meetingCardHeader\">\n            <FormattedMessage id=\"copyMeetingPage.header\" />\n          </Text>\n          <div\n            className=\"meetingCardBody\"\n            id=\"copy\"\n            dangerouslySetInnerHTML={{ __html: props.meeting?.preview ?? '' }}\n          />\n          <PrimaryButton\n            className=\"teamsButton copyButton\"\n            onClick={() => props.onCopyToClipboard(props.meeting)}\n            ariaLabel={translate('copyMeetingPage.copy.ariaLabel')}\n          >\n            <FormattedMessage id=\"copyMeetingPage.copy\" />\n          </PrimaryButton>\n        </Stack.Item>\n      </Stack>\n    </>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(CopyMeetingPageComponent);\n","import React from 'react';\nimport {\n  Stack,\n  Text,\n  PrimaryButton,\n  FontWeights\n} from 'office-ui-fabric-react';\nimport { AppState } from './RootReducer';\nimport { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { push } from 'connected-react-router';\nimport { CHECK_FOR_SIGNEDIN_USER_COMMAND } from './auth/actions';\nimport {\n  SET_MEETING_COMMAND,\n  SetMeetingCommand\n} from './meeting-creator/actions';\nimport { Header } from './components/header';\nimport { createDefaultMeetingInput } from './meeting-creator/models';\nimport { FormattedMessage } from 'react-intl';\nimport { translate } from './localization/translate';\n\nimport calendar from './images/calendar.svg';\n\nconst boldStyle = { root: { fontWeight: FontWeights.semibold } };\n\ninterface CreateLandingPageProps {\n  checkForSignedInUser: () => void;\n  onNewMeeting: () => void;\n}\n\nconst mapStateToProps = (state: AppState) => ({});\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  checkForSignedInUser: () =>\n    dispatch({\n      type: CHECK_FOR_SIGNEDIN_USER_COMMAND\n    }),\n  onNewMeeting: () => {\n    dispatch({\n      type: SET_MEETING_COMMAND,\n      meeting: createDefaultMeetingInput()\n    } as SetMeetingCommand);\n    dispatch(push('/createMeeting'));\n  }\n});\n\nfunction CreateLandingPageComponent(props: CreateLandingPageProps) {\n  // Check for a signed-in user and go to the signin page if there isn't one\n  const checkForSignedInUser = props.checkForSignedInUser;\n  React.useEffect(() => {\n    checkForSignedInUser();\n  });\n\n  return (\n    <>\n      <Header />\n      <Stack\n        className=\"container\"\n        horizontalAlign=\"center\"\n        verticalAlign=\"center\"\n        verticalFill\n        tokens={{\n          childrenGap: 35\n        }}\n      >\n        <img\n          className=\"splashImage\"\n          src={calendar}\n          alt={translate('createLandingPage.splash.altText')}\n        />\n        <Text variant=\"xLargePlus\" styles={boldStyle}>\n          <FormattedMessage id=\"createLandingPage.schedule.header\" />\n        </Text>\n        <Text variant=\"medium\">\n          <FormattedMessage id=\"createLandingPage.subheader\" />\n        </Text>\n        <PrimaryButton\n          className=\"teamsButton\"\n          onClick={() => props.onNewMeeting()}\n          ariaLabel={translate('createLandingPage.create.meeting.ariaLabel')}\n        >\n          <FormattedMessage id=\"createLandingPage.create.meeting\" />\n        </PrimaryButton>\n      </Stack>\n    </>\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(CreateLandingPageComponent);\n","import React from 'react';\nimport {\n  Stack,\n  Text,\n  FontWeights,\n  PrimaryButton,\n  DefaultButton\n} from 'office-ui-fabric-react';\nimport { AppState } from './RootReducer';\nimport { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport { goBack, replace } from 'connected-react-router';\nimport { OnlineMeetingInput } from './meeting-creator/models';\nimport {\n  CREATE_MEETING_COMMAND,\n  CreateMeetingCommand\n} from './meeting-creator/actions';\nimport { Header } from './components/header';\nimport errorImage from './images/genericError.svg';\nimport { FormattedMessage } from 'react-intl';\nimport { translate } from './localization/translate';\n\nconst boldStyle = { root: { fontWeight: FontWeights.semibold } };\n\ninterface ErrorPageProps {\n  meeting: OnlineMeetingInput;\n  goBack: () => void;\n  retryCreateMeeting: (meeting: OnlineMeetingInput) => void;\n}\n\nconst mapStateToProps = (state: AppState) => ({\n  meeting: state.meeting.inputMeeting\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  goBack: () => dispatch(goBack()),\n  retryCreateMeeting: (meeting: OnlineMeetingInput) => {\n    dispatch(replace('/createMeeting'));\n    dispatch({\n      type: CREATE_MEETING_COMMAND,\n      meeting\n    } as CreateMeetingCommand);\n  }\n});\n\nfunction ErrorPageComponent(props: ErrorPageProps) {\n  return (\n    <>\n      <Header />\n      <Stack\n        className=\"container\"\n        horizontalAlign=\"center\"\n        verticalAlign=\"center\"\n        verticalFill\n        tokens={{\n          childrenGap: 35\n        }}\n      >\n        <img className=\"splashImage\" src={errorImage} alt=\"Error graphic\" />\n        <Text variant=\"xLargePlus\" styles={boldStyle}>\n          <FormattedMessage id=\"errorPage.heading\" />\n        </Text>\n        <Text variant=\"medium\" className=\"uTextCenter\">\n          <FormattedMessage id=\"errorPage.subheading\" />\n        </Text>\n        <Stack horizontal tokens={{ childrenGap: 10 }}>\n          <DefaultButton\n            className=\"teamsButtonInverted\"\n            onClick={() => props.goBack()}\n            ariaLabel={translate('errorPage.back.ariaLabel')}\n          >\n            <FormattedMessage id=\"errorPage.back\" />\n          </DefaultButton>\n          <PrimaryButton\n            className=\"teamsButton\"\n            onClick={() => props.retryCreateMeeting(props.meeting)}\n            ariaLabel={translate('errorPage.try.again')}\n          >\n            <FormattedMessage id=\"errorPage.try.again\" />\n          </PrimaryButton>\n        </Stack>\n      </Stack>\n    </>\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ErrorPageComponent);\n","import React from 'react';\nimport { createHashHistory } from 'history';\nimport { applyMiddleware, createStore, compose } from 'redux';\nimport { Provider } from 'react-redux';\nimport { Route, Switch } from 'react-router';\nimport { ConnectedRouter, routerMiddleware } from 'connected-react-router';\nimport SigninPage from './SigninPage';\nimport { createAuthMiddleware } from './auth/middleware';\nimport MeetingPage from './MeetingPage';\nimport { createRootReducer } from './RootReducer';\nimport { createMeetingMiddleware } from './meeting-creator/middleware';\nimport CopyMeetingPage from './CopyMeetingPage';\nimport CreateLandingPage from './CreateLandingPage';\nimport ErrorPage from './ErrorPage';\nimport moment from 'moment';\nimport 'moment/min/locales.min';\nimport { initializeIcons } from 'office-ui-fabric-react';\nimport { getUserLocale } from './localization/translate';\n\nmoment.locale(getUserLocale());\n\ninitializeIcons();\n\nconst hist = createHashHistory();\n\nconst store = createStore(\n  createRootReducer(hist),\n  compose(\n    applyMiddleware(\n      routerMiddleware(hist),\n      createAuthMiddleware(),\n      createMeetingMiddleware()\n    )\n  )\n);\n\nfunction App() {\n  return (\n    <Provider store={store}>\n      <ConnectedRouter history={hist}>\n        <Switch>\n          <Route exact path=\"/signin\" component={SigninPage} />\n          <Route exact path=\"/createMeeting\" component={MeetingPage} />\n          <Route exact path=\"/copyMeeting\" component={CopyMeetingPage} />\n          <Route exact path=\"/error\" component={ErrorPage} />\n          <Route component={CreateLandingPage} />\n        </Switch>\n      </ConnectedRouter>\n    </Provider>\n  );\n}\n\nexport default App;\n","import { combineReducers } from 'redux';\nimport { connectRouter } from 'connected-react-router';\nimport { History } from 'history';\nimport { MeetingState } from './meeting-creator/state';\nimport { meetingReducer } from './meeting-creator/reducers';\n\nexport interface AppState {\n  meeting: MeetingState;\n  router: History<History.PoorMansUnknown>;\n}\n\nexport function createRootReducer(history: History) {\n  return combineReducers({\n    router: connectRouter(history),\n    meeting: meetingReducer\n  });\n}\n","import { Middleware } from 'redux';\nimport { msalApp } from './msalApp';\nimport {\n  CHECK_FOR_SIGNEDIN_USER_COMMAND,\n  OPEN_SIGNIN_DIALOG_COMMAND,\n  SIGNIN_COMPLETE_EVENT,\n  SigninCompleteEvent,\n  SIGNOUT_COMMAND,\n  SIGNOUT_COMPLETE_EVENT\n} from './actions';\nimport { replace } from 'connected-react-router';\n\nexport function createAuthMiddleware(): Middleware {\n  return store => next => action => {\n    if (action.type === CHECK_FOR_SIGNEDIN_USER_COMMAND) {\n      if (!msalApp.getAccount()) {\n        store.dispatch(replace('/signin'));\n      }\n    }\n\n    if (action.type === OPEN_SIGNIN_DIALOG_COMMAND) {\n      msalApp\n        .loginPopup({\n          scopes: ['OnlineMeetings.ReadWrite']\n        })\n        .then(response => {\n          console.log('Login succeeded');\n          store.dispatch({\n            type: SIGNIN_COMPLETE_EVENT,\n            idToken: response.idToken\n          } as SigninCompleteEvent);\n        })\n        .catch(error => {\n          console.log('Login failed:', error);\n        });\n    }\n\n    if (action.type === SIGNIN_COMPLETE_EVENT) {\n      store.dispatch(replace('/'));\n    }\n\n    if (action.type === SIGNOUT_COMMAND) {\n      msalApp.logout();\n      store.dispatch({\n        type: SIGNOUT_COMPLETE_EVENT\n      });\n      console.log('logged out?');\n    }\n\n    next(action);\n  };\n}\n","import { Middleware } from 'redux';\nimport { CREATE_MEETING_COMMAND, MEETING_CREATED_EVENT } from './actions';\nimport { createMeetingService } from './service';\nimport { push } from 'connected-react-router';\n\nexport function createMeetingMiddleware(): Middleware {\n  const service = createMeetingService();\n\n  return store => next => action => {\n    if (action.type === CREATE_MEETING_COMMAND) {\n      service\n        .createMeeting(action.meeting)\n        .then(meeting => {\n          store.dispatch({\n            type: MEETING_CREATED_EVENT,\n            meeting\n          });\n        })\n        .catch(error => {\n          console.error('Create meeting failed: ', error);\n          store.dispatch(push('/error'));\n        });\n    }\n\n    if (action.type === MEETING_CREATED_EVENT) {\n      const url = new URL(document.location.href);\n      let clientDomain = url.searchParams.get('url');\n      if (clientDomain) {\n          let returnUrl = new URL(clientDomain + '/lib/editor/atto/plugins/teamsmeeting/result.php');\n          let returnUrlSearchParams = returnUrl.searchParams;\n          returnUrlSearchParams.set('link', action.meeting.joinWebUrl);\n          returnUrlSearchParams.set('title', action.meeting.subject);\n          returnUrlSearchParams.set('preview', action.meeting.preview);\n          let msession = url.searchParams.get('msession');\n          if (msession) {\n            returnUrlSearchParams.set('session', msession);\n          }\n          returnUrl.search = returnUrlSearchParams.toString();\n          document.location.href = returnUrl.toString();\n      } else {\n          store.dispatch(push(\"/copyMeeting\"));\n      }\n    }\n    next(action);\n  };\n}","import { OnlineMeetingInput, OnlineMeeting } from './models';\r\nimport { msalApp } from '../auth/msalApp';\r\nimport axios from 'axios';\r\nimport moment from 'moment';\r\n\r\nexport function createMeetingService() {\r\n  return {\r\n    async createMeeting(meeting: OnlineMeetingInput) {\r\n      let token;\r\n      try {\r\n        token = await msalApp.acquireTokenSilent({\r\n          scopes: ['OnlineMeetings.ReadWrite']\r\n        });\r\n      } catch (ex) {\r\n        token = await msalApp.acquireTokenPopup({\r\n          scopes: ['OnlineMeetings.ReadWrite']\r\n        });\r\n      }\r\n\r\n      const requestBody = {\r\n        startDateTime: meeting.startDateTime?.toISOString(),\r\n        endDateTime: meeting.endDateTime?.toISOString(),\r\n        subject: meeting.subject\r\n      };\r\n\r\n      const response = await axios.post(\r\n        'https://graph.microsoft.com/beta/me/onlineMeetings',\r\n        requestBody,\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token.accessToken}`,\r\n            'Content-type': 'application/json'\r\n          }\r\n        }\r\n      );\r\n\r\n      const preview = decodeURIComponent(\r\n        (response.data.joinInformation.content?.split(',')?.[1] ?? '').replace(\r\n          /\\+/g,\r\n          '%20'\r\n        )\r\n      );\r\n\r\n      const createdMeeting = {\r\n        id: response.data.id,\r\n        creationDateTime: moment(response.data.creationDateTime),\r\n        subject: response.data.subject,\r\n        joinUrl: response.data.joinUrl,\r\n        joinWebUrl: response.data.joinWebUrl,\r\n        startDateTime: moment(response.data.startDateTime),\r\n        endDateTime: moment(response.data.endDateTime),\r\n        conferenceId: response.data.audioConferencing?.conferenceId || '',\r\n        tollNumber: response.data.audioConferencing?.tollNumber || '',\r\n        tollFreeNumber: response.data.audioConferencing?.tollFreeNumber || '',\r\n        dialinUrl: response.data.audioConferencing?.dialinUrl || '',\r\n        videoTeleconferenceId: response.data.videoTeleconferenceId,\r\n        preview\r\n      } as OnlineMeeting;\r\n\r\n      return createdMeeting;\r\n    }\r\n  };\r\n}\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { IntlProvider } from 'react-intl';\nimport App from './App';\nimport { getUserLocale, getMessages } from './localization/translate';\n\nconst userLocale = getUserLocale();\n\nfunction isMsalRedirect() {\n  const msalParameters = [\n    'access_token',\n    'id_token',\n    'code',\n    'error',\n    'error_description'\n  ];\n  const hash = window.location.hash;\n  return msalParameters.some(param => hash.indexOf(`${param}=`) >= 0);\n}\n\n// hack to fix MSAL fighting with hash routing\nif (!isMsalRedirect()) {\n  getMessages().then(messages => {\n    ReactDOM.render(\n      <IntlProvider locale={userLocale} messages={messages}>\n        <App />\n      </IntlProvider>,\n      document.getElementById('root')\n    );\n  });\n}\n"],"sourceRoot":""}