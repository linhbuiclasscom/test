(this["webpackJsonpteams-lms-meeting-creator"]=this["webpackJsonpteams-lms-meeting-creator"]||[]).push([[1],{102:function(e,t,a){e.exports=a.p+"static/media/signin.17dc7748.svg"},113:function(e,t,a){e.exports=a.p+"static/media/calendar.e1f946d5.svg"},114:function(e,t,a){e.exports=a.p+"static/media/genericError.b4d08b25.svg"},124:function(e,t,a){e.exports=a(155)},134:function(e,t,a){var n={"./ar/strings.json":[162,4],"./bg/strings.json":[163,5],"./cs/strings.json":[164,6],"./cy/strings.json":[165,7],"./da/strings.json":[166,8],"./de/strings.json":[167,9],"./en-gb/strings.json":[168,10],"./en-us/strings.json":[161,0],"./es-mx/strings.json":[170,11],"./es/strings.json":[169,12],"./fi/strings.json":[171,13],"./fr-ca/strings.json":[173,14],"./fr/strings.json":[172,15],"./he/strings.json":[174,16],"./is/strings.json":[175,17],"./it/strings.json":[176,18],"./ja/strings.json":[177,19],"./ko/strings.json":[178,20],"./nb/strings.json":[179,21],"./nl/strings.json":[180,22],"./nn-no/strings.json":[181,23],"./no/strings.json":[182,24],"./pl/strings.json":[183,25],"./pt-br/strings.json":[184,26],"./pt-pt/strings.json":[185,27],"./ru/strings.json":[186,28],"./sv/strings.json":[187,29],"./th/strings.json":[188,30],"./tr/strings.json":[189,31],"./zh-cn/strings.json":[190,32],"./zh-tw/strings.json":[191,33]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((function(){return a.t(r,3)}))}r.keys=function(){return Object.keys(n)},r.id=134,e.exports=r},135:function(e,t,a){},155:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(35),o=a.n(i),c=a(224),s=a(31),l=a(39),m=a(13),d=a(25),u=a(100),g=a(26),p=a(3),f=a(227),v=a(228),h=a(208),b=a(102),E=a.n(b),y=a(207),j=a(41),M=a.n(j),C=a(56),O=a(9),T=a(22),D=a.n(T),k=["ar","bg","cs","cy","da","de","en-us","en-gb","es","es-mx","fi","fr","fr-ca","he","is","it","ja","ko","nb","nl","no","nn-no","pl","pt-br","pt-pt","ru","sv","th","tr","zh-cn","zh-tw"];function x(){var e=[],t=new URL(document.location.href).searchParams.get("locale");return t&&!D.a.includes(k,t)&&(t.indexOf("_")>-1?t=t.split("_")[0]:t.indexOf("-")>-1&&(t=t.split("-")[0])),t&&D.a.includes(k,t)?e.push(t):navigator.languages?e.push(navigator.languages[0].toLocaleLowerCase()):navigator.language?e.push(navigator.language.toLocaleLowerCase()):e.push("en-us"),e[0]}var N=x();function L(){return w.apply(this,arguments)}function w(){return(w=Object(C.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!D.a.includes(k,N)){e.next=6;break}return e.next=3,a(134)("./".concat(N,"/strings.json"));case 3:t=e.sent,e.next=9;break;case 6:return e.next=8,a.e(0).then(a.t.bind(null,161,3));case 8:t=e.sent;case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}L().then((function(e){sessionStorage.setItem("translatedStrings",JSON.stringify(e.default))}));var P=sessionStorage.getItem("translatedStrings"),S=P?JSON.parse(P):{},I=Object(O.c)(),z=Object(c.a)({locale:N,messages:S},I);function B(){return(B=Object(C.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P){e.next=2;break}return e.abrupt("return",JSON.parse(P));case 2:return console.log("Translation not cached, loading..."),e.next=5,L();case 5:if(P=sessionStorage.getItem("translatedStrings")){e.next=9;break}return console.error("Unable to load translations"),e.abrupt("return",{});case 9:return S=JSON.parse(P),z=Object(c.a)({locale:N,messages:S},I),e.abrupt("return",S);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=function(e,t){return z.formatMessage({id:e},t)},U=(a(135),{root:{fontWeight:p.b.semibold}});var A=Object(m.c)((function(e){return{}}),(function(e){return{onSignIn:function(){return e({type:"OpenSigninDialogCommand"})}}}))((function(e){var t,a=null!==(t=e.onSignIn)&&void 0!==t?t:function(){};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"microsoftLogo"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"108",height:"24"},r.a.createElement("path",{d:"M44.836 4.6v13.8h-2.4V7.583H42.4L38.119 18.4h-1.588L32.142 7.583h-.029V18.4H29.9V4.6h3.436L37.3 14.83h.058L41.545 4.6zm2 1.049a1.268 1.268 0 01.419-.967 1.413 1.413 0 011-.39 1.392 1.392 0 011.02.4 1.3 1.3 0 01.4.958 1.248 1.248 0 01-.414.953 1.428 1.428 0 01-1.01.385A1.4 1.4 0 0147.25 6.6a1.261 1.261 0 01-.409-.948M49.41 18.4h-2.329V8.507h2.329zm7.064-1.694a3.213 3.213 0 001.145-.241 4.811 4.811 0 001.155-.635V18a4.665 4.665 0 01-1.266.481 6.886 6.886 0 01-1.554.164 4.707 4.707 0 01-4.918-4.908 5.641 5.641 0 011.4-3.932 5.055 5.055 0 013.955-1.545 5.414 5.414 0 011.324.168 4.431 4.431 0 011.063.39v2.233a4.763 4.763 0 00-1.1-.611 3.184 3.184 0 00-1.15-.217 2.919 2.919 0 00-2.223.9 3.37 3.37 0 00-.847 2.416 3.216 3.216 0 00.813 2.338 2.936 2.936 0 002.209.837m8.92-8.371a2.952 2.952 0 01.5.039 2.1 2.1 0 01.375.1v2.358a2.04 2.04 0 00-.534-.255 2.646 2.646 0 00-.852-.12 1.808 1.808 0 00-1.448.722 3.467 3.467 0 00-.592 2.223v4.99h-2.324V8.507h2.329v1.559h.038a2.729 2.729 0 01.963-1.266 2.611 2.611 0 011.545-.457m1 5.254a5.358 5.358 0 011.392-3.887 5.1 5.1 0 013.85-1.434 4.742 4.742 0 013.623 1.381 5.212 5.212 0 011.3 3.729 5.257 5.257 0 01-1.386 3.83 5.019 5.019 0 01-3.772 1.424 4.935 4.935 0 01-3.652-1.352 4.987 4.987 0 01-1.349-3.688m2.425-.077a3.535 3.535 0 00.7 2.368 2.505 2.505 0 002.011.818 2.345 2.345 0 001.934-.818 3.783 3.783 0 00.664-2.425 3.651 3.651 0 00-.688-2.411 2.389 2.389 0 00-1.929-.813 2.44 2.44 0 00-1.988.852 3.707 3.707 0 00-.707 2.43m11.2-2.416a1 1 0 00.318.785 5.426 5.426 0 001.4.717 4.767 4.767 0 011.959 1.256 2.6 2.6 0 01.563 1.689 2.715 2.715 0 01-1.068 2.239 4.558 4.558 0 01-2.9.847 6.978 6.978 0 01-1.362-.149 6.047 6.047 0 01-1.265-.38v-2.29a5.733 5.733 0 001.367.7 4 4 0 001.328.26 2.365 2.365 0 001.164-.221.79.79 0 00.375-.741 1.029 1.029 0 00-.39-.813 5.768 5.768 0 00-1.477-.765 4.564 4.564 0 01-1.829-1.213 2.655 2.655 0 01-.539-1.713 2.706 2.706 0 011.063-2.2 4.243 4.243 0 012.765-.86 6.663 6.663 0 011.164.115 5.161 5.161 0 011.078.3v2.214a4.974 4.974 0 00-1.078-.529 3.6 3.6 0 00-1.222-.221 1.781 1.781 0 00-1.034.26.824.824 0 00-.371.712m5.241 2.493a5.358 5.358 0 011.386-3.89 5.1 5.1 0 013.849-1.434 4.743 4.743 0 013.624 1.381 5.212 5.212 0 011.3 3.729 5.259 5.259 0 01-1.386 3.83 5.02 5.02 0 01-3.773 1.424 4.934 4.934 0 01-3.652-1.352 4.987 4.987 0 01-1.348-3.688m2.425-.077a3.537 3.537 0 00.7 2.368 2.506 2.506 0 002.011.818 2.345 2.345 0 001.934-.818 3.783 3.783 0 00.664-2.425 3.651 3.651 0 00-.688-2.411 2.39 2.39 0 00-1.93-.813 2.439 2.439 0 00-1.987.852 3.707 3.707 0 00-.707 2.43m15.464-3.109H99.7V18.4h-2.359v-7.988h-1.655V8.507h1.655V7.13a3.423 3.423 0 011.015-2.555 3.561 3.561 0 012.6-1 5.807 5.807 0 01.751.043 2.993 2.993 0 01.577.13v2.016a2.422 2.422 0 00-.4-.164 2.107 2.107 0 00-.664-.1 1.407 1.407 0 00-1.126.457 2.017 2.017 0 00-.394 1.356v1.194h3.469V6.283l2.339-.712v2.936h2.358v1.906h-2.358v4.629a1.951 1.951 0 00.332 1.29 1.326 1.326 0 001.044.375 1.557 1.557 0 00.486-.1 2.294 2.294 0 00.5-.231V18.3a2.737 2.737 0 01-.736.231 5.029 5.029 0 01-1.015.106 2.887 2.887 0 01-2.209-.784 3.341 3.341 0 01-.736-2.363z",fill:"#737373"}),r.a.createElement("path",{fill:"#f25022",d:"M0 0h10.931v10.931H0z"}),r.a.createElement("path",{fill:"#7fba00",d:"M12.069 0H23v10.931H12.069z"}),r.a.createElement("path",{fill:"#00a4ef",d:"M0 12.069h10.931V23H0z"}),r.a.createElement("path",{fill:"#ffb900",d:"M12.069 12.069H23V23H12.069z"}))),r.a.createElement(f.a,{className:"container",horizontalAlign:"center",verticalAlign:"center",verticalFill:!0,tokens:{childrenGap:35}},r.a.createElement("img",{className:"splashImage",src:E.a,alt:F("signin.logo")}),r.a.createElement(v.a,{variant:"xLargePlus",styles:U,className:"signinHeader"},r.a.createElement(y.a,{id:"signin.header"})),r.a.createElement(v.a,{variant:"medium",className:"uTextCenter signinSubHeader"},r.a.createElement(y.a,{id:"signin.subheader.lead"})),r.a.createElement(v.a,{variant:"medium",className:"uTextCenter signinSubHeader"},r.a.createElement(y.a,{id:"signin.subheader.signin"})),r.a.createElement(h.a,{className:"teamsButton",onClick:function(){return a()},ariaLabel:F("signin.button.ariaLabel")},r.a.createElement(y.a,{id:"signin.button"}))))}));var H=new(a(115).a)({auth:{clientId:"8b1a52cc-07e4-4f94-9396-31b46460b56d",authority:"https://login.microsoftonline.com/common",validateAuthority:!0,postLogoutRedirectUri:"https://nice-sky-0980a0100.azurestaticapps.net",navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ")>-1,a=e.indexOf("Trident/")>-1;return t||a}()},system:{navigateFrameWait:0}}),V=a(14);var W=a(116),G=a(222),R=a(223),_=a(232),J=a(29),q=a(87),Y=a(117),K=a(225),Q=a(106),X=a(4),Z=a.n(X);var $={root:{fontWeight:p.b.semibold}};function ee(e){var t="";return Math.floor(e.asDays())>0&&(t+="".concat(Math.floor(e.asDays()),"d ")),e.hours()>0&&(t+="".concat(e.hours(),"h ")),e.minutes()>0&&(t+="".concat(e.minutes(),"m ")),t}var te=Object(p.s)({fontSize:16,height:16,width:16,margin:"0 7px",position:"relative",top:1,backgroundColor:"#6264a7",padding:"10px",color:"#fff",borderRadius:"3px"}),ae=Object(p.s)({position:"relative",top:7});function ne(e){var t,a,n;var i=D.a.range(0,1440,30).map((function(t){var a=Z()(e.dateTime).startOf("day").add(Z.a.duration(t,"minutes")),n=Z()(e.minDate).isAfter(a),r=Z()().startOf("day").minutes(t).format("LT"),i=Z.a.duration(Z()(a).diff(e.minDate)),o=D.a.trim(ee(i));return{key:t,text:e.includeDuration&&!n&&o.length>0?"".concat(r," (").concat(o,")"):r,disabled:n}}));return r.a.createElement(f.a,{horizontal:!0},r.a.createElement(G.a,{className:"newMeetingDatePicker",borderless:!0,firstDayOfWeek:Z.a.localeData().firstDayOfWeek(),strings:function(){var e=Z.a.localeData();return{months:e.months(),shortMonths:e.monthsShort(),days:e.weekdays(),shortDays:e.weekdaysMin(),goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",closeButtonAriaLabel:"Close date picker"}}(),value:null===(t=e.dateTime)||void 0===t?void 0:t.toDate(),formatDate:function(e){return Z()(e).format("ll")},parseDateFromString:function(e){return Z()(e,"ll").toDate()},onSelectDate:function(t){var a=Z()(e.dateTime),n=a.diff(Z()(a).startOf("day")),r=Z()(null!==t&&void 0!==t?t:a).startOf("day").add(n);e.onTimeUpdated(r)},minDate:null===(a=e.minDate)||void 0===a?void 0:a.toDate()}),r.a.createElement(R.a,{className:"newMeetingComboBox",styles:{root:{maxHeight:"500px"}},useComboBoxAsMenuWidth:!e.includeDuration,scrollSelectedToTop:!0,allowFreeform:!0,autoComplete:"on",options:i,onChange:function(t,a,n,r){var i,o=Z()(e.dateTime).startOf("day");if(a){var c=Z.a.duration(a.key,"minutes");i=o.add(c)}else{var s=Z()(r,"LT");if(s.isValid()){var l=s.diff(Z()(s).startOf("day"));i=o.add(l)}else i=Z()(e.dateTime)}e.onTimeUpdated(i)},text:null===(n=e.dateTime)||void 0===n?void 0:n.format("LT")}),"ReplyAlt"===e.iconName?r.a.createElement(Q.a,{className:"newMeetingPickerIcon",iconName:e.iconName}):r.a.createElement(v.a,{className:"newMeetingPickerIncrement",variant:"smallPlus"},ee(Z.a.duration(Z()(e.dateTime).diff(Z()(e.minDate))))))}var re=Object(m.c)((function(e){return{meeting:e.meeting.inputMeeting,creationInProgress:e.meeting.creationInProgress,validationFailures:{invalidTitle:(t=e.meeting.inputMeeting,t.subject&&t.subject.length>=0?void 0:"Invalid subject")}};var t}),(function(e){return{setMeeting:function(t){e({type:"SetMeetingCommand",meeting:t})},createMeeting:function(t){e({type:"CreateMeetingCommand",meeting:t})},cancel:function(){return e(Object(V.c)())}}}))((function(e){var t,a=Object(n.useState)(!1),i=Object(W.a)(a,2),o=i[0],c=i[1];function s(){e.validationFailures.invalidTitle?c(!0):e.createMeeting(e.meeting)}return e.creationInProgress?r.a.createElement("div",{className:"spinnerContainer"},r.a.createElement(_.a,{size:J.a.large})):r.a.createElement("div",{className:"newMeetingContainer"},r.a.createElement(f.a,{className:"container",verticalFill:!0,tokens:{childrenGap:35}},r.a.createElement(f.a,{horizontal:!0,tokens:{childrenGap:15}},r.a.createElement(q.a,{grow:!0},r.a.createElement(Q.a,{iconName:"Calendar",className:te}),r.a.createElement(v.a,{variant:"xLarge",styles:$},r.a.createElement(y.a,{id:"meetingPage.header"}))),r.a.createElement(q.a,{align:"end",className:"newMeetingButtons"},r.a.createElement(f.a,{horizontal:!0,tokens:{childrenGap:10}},r.a.createElement(h.a,{className:"teamsButton",disabled:e.creationInProgress,onClick:function(){return s()},ariaLabel:F("meetingPage.create.ariaLabel")},r.a.createElement(y.a,{id:"meetingPage.create"})),r.a.createElement(Y.a,{className:"teamsButtonInverted",disabled:e.creationInProgress,onClick:function(){return e.cancel()},ariaLabel:F("meetingPage.cancel.ariaLabel")},r.a.createElement(y.a,{id:"meetingPage.cancel"}))))),r.a.createElement(f.a,{horizontal:!0},r.a.createElement(q.a,{className:"newMeetingInputIcon"},r.a.createElement(Q.a,{iconName:"Edit",className:ae})),r.a.createElement(q.a,{grow:!0},r.a.createElement(K.a,{className:"newMeetingInput",placeholder:F("meetingPage.title.input"),value:null===(t=e.meeting)||void 0===t?void 0:t.subject,underlined:!0,onChange:function(t,a){var n=D.a.cloneDeep(e.meeting);n.subject=null!==a&&void 0!==a?a:"",e.setMeeting(n)},errorMessage:o?e.validationFailures.invalidTitle:void 0}))),r.a.createElement("div",{className:"newMeetingDatePickerContainer"},r.a.createElement(Q.a,{iconName:"Clock",className:ae}),r.a.createElement("div",{className:"newMeetingPicker"},r.a.createElement(ne,{dateTime:e.meeting.startDateTime,minDate:Z()(),onTimeUpdated:function(t){var a=D.a.cloneDeep(e.meeting);if(a.startDateTime=null!==t&&void 0!==t?t:a.startDateTime,a.startDateTime.isSameOrAfter(a.endDateTime)){var n=Z()(e.meeting.endDateTime).diff(Z()(e.meeting.startDateTime)),r=Z()(a.startDateTime).add(n);a.startDateTime.isSameOrAfter(r)&&r.add(n),a.endDateTime=r}e.setMeeting(a)},includeDuration:!1,iconName:"ReplyAlt"}),r.a.createElement(ne,{dateTime:e.meeting.endDateTime,minDate:e.meeting.startDateTime,onTimeUpdated:function(t){var a=D.a.cloneDeep(e.meeting),n=null!==t&&void 0!==t?t:a.endDateTime;a.startDateTime.isAfter(n)||(a.endDateTime=n),e.setMeeting(a)},includeDuration:!0})))),r.a.createElement(q.a,{className:"newMeetingButtonsMobile"},r.a.createElement(f.a,{horizontal:!0,tokens:{childrenGap:10}},r.a.createElement(h.a,{className:"teamsButton teamsButtonFullWidth",disabled:e.creationInProgress,onClick:function(){return s()},ariaLabel:F("meetingPage.create.ariaLabel")},r.a.createElement(y.a,{id:"meetingPage.create"})),r.a.createElement(Y.a,{className:"teamsButtonInverted teamsButtonFullWidth",disabled:e.creationInProgress,onClick:function(){return e.cancel()},ariaLabel:F("meetingPage.cancel.ariaLabel")},r.a.createElement(y.a,{id:"meetingPage.cancel"})))))})),ie=a(60);function oe(){return{subject:"",startDateTime:Z()().startOf("hour").add(1,"hour"),endDateTime:Z()().startOf("hour").add(2,"hour")}}var ce=function(e,t){if(!e)return{inputMeeting:oe(),creationInProgress:!1};switch(t.type){case"SetMeetingCommand":return Object(ie.a)({},e,{inputMeeting:D.a.cloneDeep(t.meeting)});case"CreateMeetingCommand":return Object(ie.a)({},e,{creationInProgress:!0});case"MeetingCreatedEvent":return Object(ie.a)({},e,{createdMeeting:t.meeting});case V.b:if("/createMeeting"===t.payload.location.pathname)return Object(ie.a)({},e,{creationInProgress:!1});default:return e}};var se=a(112),le=a.n(se);var me=a(234),de={root:{fontWeight:p.b.bold}};var ue=Object(m.c)((function(e){return{}}),(function(e){return{onSignOut:function(){e({type:"SignoutCommand"})}}}))((function(e){var t,a=null!==(t=e.onSignOut)&&void 0!==t?t:function(){};return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"headerLogo"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2228.833 2073.333"},r.a.createElement("path",{fill:"#5059C9",d:"M1554.637 777.5h575.713c54.391 0 98.483 44.092 98.483 98.483v524.398c0 199.901-162.051 361.952-361.952 361.952h-1.711c-199.901.028-361.975-162-362.004-361.901V828.971c.001-28.427 23.045-51.471 51.471-51.471z"}),r.a.createElement("circle",{fill:"#5059C9",cx:"1943.75",cy:"440.583",r:"233.25"}),r.a.createElement("circle",{fill:"#7B83EB",cx:"1218.083",cy:"336.917",r:"336.917"}),r.a.createElement("path",{fill:"#7B83EB",d:"M1667.323 777.5H717.01c-53.743 1.33-96.257 45.931-95.01 99.676v598.105c-7.505 322.519 247.657 590.16 570.167 598.053 322.51-7.893 577.671-275.534 570.167-598.053V877.176c1.245-53.745-41.268-98.346-95.011-99.676z"}),r.a.createElement("path",{opacity:".1",d:"M1244 777.5v838.145c-.258 38.435-23.549 72.964-59.09 87.598a91.856 91.856 0 01-35.765 7.257H667.613c-6.738-17.105-12.958-34.21-18.142-51.833a631.287 631.287 0 01-27.472-183.49V877.02c-1.246-53.659 41.198-98.19 94.855-99.52H1244z"}),r.a.createElement("path",{opacity:".2",d:"M1192.167 777.5v889.978a91.838 91.838 0 01-7.257 35.765c-14.634 35.541-49.163 58.833-87.598 59.09H691.975c-8.812-17.105-17.105-34.21-24.362-51.833-7.257-17.623-12.958-34.21-18.142-51.833a631.282 631.282 0 01-27.472-183.49V877.02c-1.246-53.659 41.198-98.19 94.855-99.52h475.313z"}),r.a.createElement("path",{opacity:".2",d:"M1192.167 777.5v786.312c-.395 52.223-42.632 94.46-94.855 94.855h-447.84A631.282 631.282 0 01622 1475.177V877.02c-1.246-53.659 41.198-98.19 94.855-99.52h475.312z"}),r.a.createElement("path",{opacity:".2",d:"M1140.333 777.5v786.312c-.395 52.223-42.632 94.46-94.855 94.855H649.472A631.282 631.282 0 01622 1475.177V877.02c-1.246-53.659 41.198-98.19 94.855-99.52h423.478z"}),r.a.createElement("path",{opacity:".1",d:"M1244 509.522v163.275c-8.812.518-17.105 1.037-25.917 1.037-8.812 0-17.105-.518-25.917-1.037a284.472 284.472 0 01-51.833-8.293c-104.963-24.857-191.679-98.469-233.25-198.003a288.02 288.02 0 01-16.587-51.833h258.648c52.305.198 94.657 42.549 94.856 94.854z"}),r.a.createElement("path",{opacity:".2",d:"M1192.167 561.355v111.442a284.472 284.472 0 01-51.833-8.293c-104.963-24.857-191.679-98.469-233.25-198.003h190.228c52.304.198 94.656 42.55 94.855 94.854z"}),r.a.createElement("path",{opacity:".2",d:"M1192.167 561.355v111.442a284.472 284.472 0 01-51.833-8.293c-104.963-24.857-191.679-98.469-233.25-198.003h190.228c52.304.198 94.656 42.55 94.855 94.854z"}),r.a.createElement("path",{opacity:".2",d:"M1140.333 561.355v103.148c-104.963-24.857-191.679-98.469-233.25-198.003h138.395c52.305.199 94.656 42.551 94.855 94.855z"}),r.a.createElement("linearGradient",{id:"a",gradientUnits:"userSpaceOnUse",x1:"198.099",y1:"1683.073",x2:"942.234",y2:"394.261",gradientTransform:"matrix(1 0 0 -1 0 2075.333)"},r.a.createElement("stop",{offset:"0",style:{stopColor:"#5a62c3"}}),r.a.createElement("stop",{offset:".5",style:{stopColor:"#4d55bd"}}),r.a.createElement("stop",{offset:"1",style:{stopColor:"#3940ab"}})),r.a.createElement("path",{fill:"url(#a)",d:"M95.01 466.5h950.312c52.473 0 95.01 42.538 95.01 95.01v950.312c0 52.473-42.538 95.01-95.01 95.01H95.01c-52.473 0-95.01-42.538-95.01-95.01V561.51c0-52.472 42.538-95.01 95.01-95.01z"}),r.a.createElement("path",{fill:"#FFF",d:"M820.211 828.193h-189.97v517.297h-121.03V828.193H320.123V727.844h500.088v100.349z"}))),r.a.createElement("div",null,r.a.createElement(v.a,{variant:"xLarge",styles:de},"Microsoft Teams")),r.a.createElement("div",{className:"headerIcon"},r.a.createElement(me.a,{onClick:function(){return a()},iconProps:{iconName:"Leave"},title:F("header.signout.title"),ariaLabel:F("header.signout.ariaLabel")})))}));var ge=Object(m.c)((function(e){return{meeting:e.meeting.createdMeeting}}),(function(e){return{onCopyToClipboard:function(e){var t,a=(null===(t=document.getElementById("copy"))||void 0===t?void 0:t.innerHTML)||F("copyMeetingPage.failed.copy");function n(t){var n;t&&t.clipboardData&&(t.clipboardData.setData("text/html",a),t.clipboardData.setData("text/plain",null!==(n=null===e||void 0===e?void 0:e.joinWebUrl)&&void 0!==n?n:F("copyMeetingPage.failed.copy")),t.preventDefault())}document.addEventListener("copy",n),document.execCommand("copy"),document.removeEventListener("copy",n)}}}))((function(e){var t,a;return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue,null),r.a.createElement(f.a,{className:"container",verticalFill:!0,tokens:{childrenGap:35}},r.a.createElement(f.a.Item,{align:"center",className:"meetingCardContainer"},r.a.createElement("svg",{className:"meetingSuccess",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},r.a.createElement("path",{d:"M24 0c2.2 0 4.3.3 6.4.9 2 .6 3.9 1.4 5.7 2.4 1.8 1 3.4 2.3 4.9 3.8 1.5 1.5 2.7 3.1 3.8 4.9 1 1.8 1.8 3.7 2.4 5.7.6 2 .9 4.2.9 6.4s-.3 4.3-.9 6.3c-.6 2-1.4 3.9-2.4 5.7-1 1.8-2.3 3.4-3.8 4.9-1.5 1.5-3.1 2.7-4.9 3.8-1.8 1-3.7 1.9-5.7 2.4-2 .6-4.1.9-6.4.9-2.2 0-4.3-.3-6.3-.9-2-.6-3.9-1.4-5.7-2.4-1.8-1-3.4-2.3-4.9-3.8-1.5-1.5-2.7-3.1-3.8-4.9-1-1.8-1.9-3.7-2.4-5.7C.3 28.3 0 26.2 0 24s.3-4.3.9-6.4c.6-2 1.4-3.9 2.4-5.7 1-1.8 2.3-3.4 3.8-4.9 1.5-1.5 3.1-2.7 4.9-3.8 1.8-1 3.7-1.9 5.7-2.4S21.8 0 24 0zm7.9 17.1c-.6 0-1.2.2-1.6.7l-8.5 8.5-3-3c-.4-.4-1-.7-1.6-.7-.3 0-.6.1-.8.2-.3.1-.5.3-.7.5s-.4.4-.5.7c-.2.3-.2.5-.2.8 0 .6.2 1.2.7 1.6l4.6 4.6c.4.4 1 .7 1.6.7.6 0 1.2-.2 1.6-.7l10.1-10.1c.4-.5.7-1 .7-1.6 0-.3-.1-.6-.2-.8-.1-.3-.3-.5-.5-.7s-.4-.4-.7-.5c-.4-.2-.7-.2-1-.2z",fill:"#599c00"})),r.a.createElement(v.a,{block:!0,variant:"xLarge",className:"meetingCardHeader"},r.a.createElement(y.a,{id:"copyMeetingPage.header"})),r.a.createElement("div",{className:"meetingCardBody",id:"copy",dangerouslySetInnerHTML:{__html:null!==(t=null===(a=e.meeting)||void 0===a?void 0:a.preview)&&void 0!==t?t:""}}),r.a.createElement(h.a,{className:"teamsButton copyButton",onClick:function(){return e.onCopyToClipboard(e.meeting)},ariaLabel:F("copyMeetingPage.copy.ariaLabel")},r.a.createElement(y.a,{id:"copyMeetingPage.copy"})))))})),pe=a(113),fe=a.n(pe),ve={root:{fontWeight:p.b.semibold}};var he=Object(m.c)((function(e){return{}}),(function(e){return{checkForSignedInUser:function(){return e({type:"CheckForSignedInUserCommand"})},onNewMeeting:function(){e({type:"SetMeetingCommand",meeting:oe()}),e(Object(V.e)("/createMeeting"))}}}))((function(e){var t=e.checkForSignedInUser;return r.a.useEffect((function(){t()})),r.a.createElement(r.a.Fragment,null,r.a.createElement(ue,null),r.a.createElement(f.a,{className:"container",horizontalAlign:"center",verticalAlign:"center",verticalFill:!0,tokens:{childrenGap:35}},r.a.createElement("img",{className:"splashImage",src:fe.a,alt:F("createLandingPage.splash.altText")}),r.a.createElement(v.a,{variant:"xLargePlus",styles:ve},r.a.createElement(y.a,{id:"createLandingPage.schedule.header"})),r.a.createElement(v.a,{variant:"medium"},r.a.createElement(y.a,{id:"createLandingPage.subheader"})),r.a.createElement(h.a,{className:"teamsButton",onClick:function(){return e.onNewMeeting()},ariaLabel:F("createLandingPage.create.meeting.ariaLabel")},r.a.createElement(y.a,{id:"createLandingPage.create.meeting"}))))})),be=a(114),Ee=a.n(be),ye={root:{fontWeight:p.b.semibold}};var je=Object(m.c)((function(e){return{meeting:e.meeting.inputMeeting}}),(function(e){return{goBack:function(){return e(Object(V.c)())},retryCreateMeeting:function(t){e(Object(V.f)("/createMeeting")),e({type:"CreateMeetingCommand",meeting:t})}}}))((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ue,null),r.a.createElement(f.a,{className:"container",horizontalAlign:"center",verticalAlign:"center",verticalFill:!0,tokens:{childrenGap:35}},r.a.createElement("img",{className:"splashImage",src:Ee.a,alt:"Error graphic"}),r.a.createElement(v.a,{variant:"xLargePlus",styles:ye},r.a.createElement(y.a,{id:"errorPage.heading"})),r.a.createElement(v.a,{variant:"medium",className:"uTextCenter"},r.a.createElement(y.a,{id:"errorPage.subheading"})),r.a.createElement(f.a,{horizontal:!0,tokens:{childrenGap:10}},r.a.createElement(Y.a,{className:"teamsButtonInverted",onClick:function(){return e.goBack()},ariaLabel:F("errorPage.back.ariaLabel")},r.a.createElement(y.a,{id:"errorPage.back"})),r.a.createElement(h.a,{className:"teamsButton",onClick:function(){return e.retryCreateMeeting(e.meeting)},ariaLabel:F("errorPage.try.again")},r.a.createElement(y.a,{id:"errorPage.try.again"})))))})),Me=(a(154),a(220));Z.a.locale(x()),Object(Me.a)();var Ce,Oe=Object(s.a)(),Te=Object(l.e)((Ce=Oe,Object(l.c)({router:Object(g.b)(Ce),meeting:ce})),Object(l.d)(Object(l.a)(Object(u.a)(Oe),(function(e){return function(t){return function(a){"CheckForSignedInUserCommand"===a.type&&(H.getAccount()||e.dispatch(Object(V.f)("/signin"))),"OpenSigninDialogCommand"===a.type&&H.loginPopup({scopes:["OnlineMeetings.ReadWrite"]}).then((function(t){console.log("Login succeeded"),e.dispatch({type:"SigninCompleteEvent",idToken:t.idToken})})).catch((function(e){console.log("Login failed:",e)})),"SigninCompleteEvent"===a.type&&e.dispatch(Object(V.f)("/")),"SignoutCommand"===a.type&&(H.logout(),e.dispatch({type:"SignoutCompleteEvent"}),console.log("logged out?")),t(a)}}}),function(){var e={createMeeting:function(e){return Object(C.a)(M.a.mark((function t(){var a,n,r,i,o,c,s,l,m,d,u,g,p,f;return M.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,H.acquireTokenSilent({scopes:["OnlineMeetings.ReadWrite"]});case 3:d=t.sent,t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(0),t.next=10,H.acquireTokenPopup({scopes:["OnlineMeetings.ReadWrite"]});case 10:d=t.sent;case 11:return u={startDateTime:null===(a=e.startDateTime)||void 0===a?void 0:a.toISOString(),endDateTime:null===(n=e.endDateTime)||void 0===n?void 0:n.toISOString(),subject:e.subject},t.next=14,le.a.post("https://graph.microsoft.com/beta/me/onlineMeetings",u,{headers:{Authorization:"Bearer ".concat(d.accessToken),"Content-type":"application/json"}});case 14:return g=t.sent,p=decodeURIComponent((null!==(r=null===(i=g.data.joinInformation.content)||void 0===i||null===(o=i.split(","))||void 0===o?void 0:o[1])&&void 0!==r?r:"").replace(/\+/g,"%20")),f={id:g.data.id,creationDateTime:Z()(g.data.creationDateTime),subject:g.data.subject,joinUrl:g.data.joinUrl,joinWebUrl:g.data.joinWebUrl,startDateTime:Z()(g.data.startDateTime),endDateTime:Z()(g.data.endDateTime),conferenceId:(null===(c=g.data.audioConferencing)||void 0===c?void 0:c.conferenceId)||"",tollNumber:(null===(s=g.data.audioConferencing)||void 0===s?void 0:s.tollNumber)||"",tollFreeNumber:(null===(l=g.data.audioConferencing)||void 0===l?void 0:l.tollFreeNumber)||"",dialinUrl:(null===(m=g.data.audioConferencing)||void 0===m?void 0:m.dialinUrl)||"",videoTeleconferenceId:g.data.videoTeleconferenceId,preview:p},t.abrupt("return",f);case 18:case"end":return t.stop()}}),t,null,[[0,6]])})))()}};return function(t){return function(a){return function(n){if("CreateMeetingCommand"===n.type&&e.createMeeting(n.meeting).then((function(e){t.dispatch({type:"MeetingCreatedEvent",meeting:e})})).catch((function(e){console.error("Create meeting failed: ",e),t.dispatch(Object(V.e)("/error"))})),"MeetingCreatedEvent"===n.type){var r=new URL(document.location.href),i=r.searchParams.get("url");if(i){var o=new URL(i+"/lib/editor/atto/plugins/teamsmeeting/result.php"),c=o.searchParams;c.set("link",n.meeting.joinWebUrl),c.set("title",n.meeting.subject),c.set("preview",n.meeting.preview);var s=r.searchParams.get("msession");s&&c.set("session",s),o.search=c.toString(),document.location.href=o.toString()}else t.dispatch(Object(V.e)("/copyMeeting"))}a(n)}}}}())));var De=function(){return r.a.createElement(m.a,{store:Te},r.a.createElement(g.a,{history:Oe},r.a.createElement(d.c,null,r.a.createElement(d.a,{exact:!0,path:"/signin",component:A}),r.a.createElement(d.a,{exact:!0,path:"/createMeeting",component:re}),r.a.createElement(d.a,{exact:!0,path:"/copyMeeting",component:ge}),r.a.createElement(d.a,{exact:!0,path:"/error",component:je}),r.a.createElement(d.a,{component:he}))))},ke=x();(function(){var e=window.location.hash;return["access_token","id_token","code","error","error_description"].some((function(t){return e.indexOf("".concat(t,"="))>=0}))})()||function(){return B.apply(this,arguments)}().then((function(e){o.a.render(r.a.createElement(c.b,{locale:ke,messages:e},r.a.createElement(De,null)),document.getElementById("root"))}))}},[[124,2,3]]]);
//# sourceMappingURL=main.1702811c.chunk.js.map